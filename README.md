# How can we create our own Spring Framework by following IOC

All frameworks in java uses the core building blocks offered by the Java language itself such as reflection plus another practice called the bytecode enhancing. Otherwise they heavily rely on the Java Enterprise edition technologies like Servlet and Filters. Without them being around, I had worked in projects where we ourselves wrote our own framework involving servlets and filters. However, our framework were not that advanced to handle IOC. So if we know the advanced design choices / requirements supported a framework like Spring, and we have deep expertise in the Java and Java Enterprise edition, we can build our own Spring Framework. One thing to keep in mind, though. Large open source frameworks like Spring is not the creation of a single person. Spring Framework has different modules and each module has several people contributing to the design and code.

Two things are cited very frequently in Spring Framework discussion and they are the # Dependency # Injection or DI and # Inversion of # Control or IOC. The secret of understanding the meaning of them is being really good with our English knowledge. The secret of understanding off all Information Technology, not just Spring,  is being good at English language and applying that knowledge in understanding technology. Now, lets consider DI or Dependency Injection. It is indeed a plain English phrase consisting of two words. The first word is Dependency and it means some object living or non living , that needs another object for birth, survival and proper functioning. As living human beings, we can say we have a dependency on Oxygen. I have a dependency on my morning coffee. Fish has a dependency on water. Plants have a dependency on Carbon DI Oxide to perform photosynthesis to make food etc. Life on earth has a dependency on the Sun. The example of dependencies experienced by us in the universe are plenty. 

Now, let us come to the second word, which is injection. It is another English word I came to know when I was a little child. When I used get a fever , some Doctor used that dreaded word to put a middle in my arms and called the painful process an injection. Coming back to the nature itself, nature uses plants to inject oxygen into the atmosphere which we then breathe. Nature also injects sunlight, water, soil, river, land into our living environment. We as living beings have not created any of the objects such as oxygen we need for living. Someone else injects them into the environment for us to use. 

As you may have noticed I have not used technology much till this point in the discussion. I did that because to prepare a context. Spring Framework borrows heavily from these natural environmental English language words / phrases and uses them for our benefit. It is naive to ignore the English meaning of technical terms when we try to understand technology. We can imagine objects living their life within the Java VM are very much like an animal living and being on earth. However, before Spring Framework existed, java application objects used to create their dependent object all by their own. This is similar to imagining I create my own oxygen to breathe, you do so for your own, Fish creates water, Cow creates grass, Tigers giving birth to deer before eating them and so on. So objects creating their own dependencies is not a natural concept but an artificial one. What is an example of an Object dependency? If we write a program to access and read data from a MySQL database our program will need a MySQL connection. If our program is used by a lot of people, we will need a pool of connection to MySQL. This MySQL connection / pool of connection is an object our data accessing program depends on. Without Spring , our program will create its own MySQL connection. With Spring, the framework itself will create these dependent objects like mother nature does for us and inject the MySQL connection to our program. 

# What is the advantage?

Say humans has a dependency of Oxygen. Oxygen is available in atmosphere on land and in water. However, our lungs cannot access the oxygen available from water. Fish can. So we fulfill our oxygen dependency by taking an oxygen tank with us during scuba diving under water. That oxygen tank is again not created by us but given or injected to us by the diving company. So we can fulfill the dependency requirement in multiple flexible ways if we are open to accept objects from outside environment. That is where dependency injection bring flexibility. Say  now that our program is ready and we need to test it. The MySQL DBA however is vacationing in Florida and will not return until next week. We can however, go ahead and tell Spring to inject a memory held Database connection like H2 and proceed with testing. If our program had hard coded the MySQL driver manager connection creation on startup instead of Spring injecting it to our program, our program would he hard dependent on the DBA returning from Florida and won't be able to test till then.

The next most important English term is Inversion of Control. It is another English phrase that starts with Inversion. What do we get when we invert the fraction 1/3? We get 3/1 or 3. So Inversion is the process of flipping (turning an object upside down) an object. When our program creates all its dependent objects, we say it has full control and all the lack of flexibility that comes with it. When Spring Framework takes the control away from out program, creates the dependent objects and injects them to our program, we call it Inversion of Control or IOC. As I said, the better we understand English language terms and phrases , the better we will understand information technology.

All that being said, not all program have the same dependency. Tigers can eat raw meat. Humans (most of them) have to cook meat before they are eaten. Some humans do not eat meat and call themselves vegetarians. Similarly, some program may access MySQL while others may access Oracle. Some other may access ActiveMQ or RabbitMQ. Some programs may need Jackson JSON processor or others may need Google's GSON. A REST Controller may need a Service while that Service may need a Data Access Object Repository. All these different dependencies need to be specified to Spring in some way. We have multiple ways of doing so in Spring. We can use old XML but it still works. We can also use Java configuration or we can use annotations. Spring reads these XML, annotations or java config and creates objects on our behalf and injects them to our program. 

# How does Apache Tomcat Processes Requests from multiple users?

# Answer 

Servlet containers like Tomcat / Jetty have a pool / collection of threads say 200. These pool of threads is created when the container starts. When individual user's request is received by the server, it picks a thread from that pool and that single thread is actually working only for that single user, waiting on IO, doing CPU processing etc. When the processing is complete, it is this thread that sends the user's response to the user and goes back to the pool to serve another user'

This model has some limitation when a lot of traffic comes to the server and the available threads are exhausted. Normally it is solved by creating a pool of the servlet container itself like 10 Tomcat server and putting them behind a load balancer. User first reach their LoadBalancer and the LB distributes the traffic to the pool of Tomcats.

# What is the difference between Aggregation and Composition in Object Oriented Programming

# Answer

All things that are Information Technology are present so vividly in real life, that we may do well to understand the English meaning of the term and look for real life examples. The word compose is present in the music industry since hundreds of years before it came to programming as composition. In the music industry, a music director composes songs from lyrics, notes, beats and instrument players. So when several smaller objects / things are combined together to form one object i.e. song, we say that song is composed of lyrics, notes, beats and other things.

Similarly in Object Oriented programming, which obviously came from life experiences of the creators, not the other way round, composition means using smaller things to make something bigger. So when we are using @Autowired for a Service class instance inside a Controller, we are making the controller using a service instance. We can also say the song has lyrics in real life, the controller has a service attribute in programming, A Cow has four legs in real life, the Cow class consists of an array of Leg objects etc.

Aggregation is about hierarchy / inheritance. Human children has their outer and inner organs which is composition. However, how these organs look and work may have been "aggregated" from the genes of their parents and grandparents. A Tiger inherits his Lung from his parent Tiger and Tigress, a Fish inherits his / her gills from his / her parent Fish, Mukesh inherited his wealth partly from Dhirubhai. Aggregation is all about summation as well. We add up genes from parents / grandparents on each side and arrive at a certain child . Similarly, rich parents of a certain child contribute their own money which is then "aggregated" in the child's wealth.

In programming, when we give birth to children by "extending" a parent class we call it aggregation. We extend an Animal class to create Tigers, Cows etc. But as the teeth of a Tiger is different from that of a Cow, we compose of different kinds of teeth in Tigers and Cows.
